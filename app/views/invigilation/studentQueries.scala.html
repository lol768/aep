@import domain.{AnnouncementOrQuery, Assessment, SittingMetadata, StudentAssessment, tabula}
@import tags._
@import warwick.sso.UniversityID

@(
  assessment: Assessment,
  studentAssessment: StudentAssessment,
  announcementsAndQueries: Seq[AnnouncementOrQuery],
  student: Map[UniversityID, tabula.SitsProfile],
  department: Option[tabula.Department],
)(implicit request: RequestHeader, messagesProvider: MessagesProvider, context: RequestContext)

@adminLayout("Queries from " + student.get(studentAssessment.studentId).map(_.fullName).getOrElse(studentAssessment.studentId.string) + " for " + assessment.moduleCode, extraClasses = Seq("connect-ws")) {
  <div class="id7-main-content">
    <span class="in-progress-assessment-data" data-assessment="@assessment.id" data-usercode="@context.user.map(_.usercode.string)"></span>
    @studentAssessmentInfo(Seq(SittingMetadata(studentAssessment, assessment.asAssessmentMetadata)), assessment.platform, student, viewAnnouncementsAndQueries = Some(s => controllers.invigilation.routes.AnnouncementAndQueriesController.view(assessment.id, s.studentId)))
    <div class="row">
      <div class="col-md-6">
        <h3>Announcements</h3>
        @displayAnnouncementsAndQueries(announcementsAndQueries.filter(_.isAnnouncement), student, "announcement")
      </div>
      <div class="col-md-6">
        <h3>Queries</h3>
        @displayAnnouncementsAndQueries(announcementsAndQueries.filter(_.isQuery), student, "query")
      </div>
    </div>
    <a class="btn btn-default" href="@controllers.invigilation.routes.InvigilatorAssessmentController.view(assessment.id)">
      <i class="fas fa-arrow-left"></i>
      Return to invigilation screen
    </a>
  </div>
}
