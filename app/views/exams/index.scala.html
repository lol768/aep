@import warwick.core.helpers.JavaTime
@import org.apache.commons.lang3.time.DurationFormatUtils
@import domain.Assessment.Platform
@import domain.Assessment.AssessmentType
@import domain.Assessment
@import domain.StudentAssessmentWithAssessment

@(assessments: Seq[StudentAssessmentWithAssessment])(implicit context: RequestContext)

@frontend("My exams", extraClasses = Seq("grey-nopad")) {

  <div class="media">
    <div class="media-left">
      <i class="fa fa-exclamation-triangle text-danger"></i>
    </div>
    <div class="media-body">
      This page lists all the exams you are scheduled to take during summer 2020. Please check carefully to make sure that all the exams you expect to take are shown here; if an exam does not appear in this list, you will not be able to take it. If there are exams you are expecting to take which do not appear here, please <a href="mailto:someone">tell us about it as soon as possible</a>.
    </div>
  </div>

  <hr>

@*  <div class="panel panel-default panel-lg">*@
@*    <div class="panel-body">*@
@*      <h2>Your in-progress exam</h2>*@

@*      <p>CS118-15 Open book Java programming</p>*@

@*      <p>*@
@*        <span class="text-muted">*@
@*          <i class="fad fa-fw fa-hourglass-half"></i>Started 1 hour 2 minutes ago. 1 hour 57 minutes remaining*@
@*        </span>*@
@*      </p>*@

@*      <a href="/service/stub" class="btn btn-primary btn-lg">*@
@*        Continue*@
@*      </a>*@
@*    </div>*@
@*  </div>*@

  @assessments.grouped(2).map { row =>
    <div class="row">
      @row.map { a =>
        <div class="col-md-6">
          <div class="panel panel-default">
            <div class="panel-body">
              <h4>@a.assessment.title</h4>

              <dl>
                <dt>Module</dt>
                <dd>
                @a.assessment.code
                </dd>
                <dt>Type</dt>
                <dd>
                @a.assessment.assessmentType match {
                  case AssessmentType.OpenBook => { Open book }
                  case AssessmentType.Spoken => { Spoken }
                  case AssessmentType.MultipleChoice => { Multiple choice }
                }
                </dd>
                <dt>Duration</dt>
                <dd>
                  <i class="fad fa-stopwatch fa-fw"></i>@DurationFormatUtils.formatDurationWords(a.assessment.duration.toMillis, true, true)
                </dd>
                @a.assessment.startTime.map { startTime =>
                  <dt>Can start</dt>
                  <dd>
                    <i class="fad fa-clock fa-fw"></i>@JavaTime.Relative(startTime.plusHours(8))
                    until
                  @JavaTime.Relative(startTime.plus(Assessment.window).plusHours(8))
                  <span class="text-muted">Asia/Shanghai</span>
                  <br>
                  <i class="fad fa-clock fa-fw"></i>@JavaTime.Relative(startTime)
                    until
                  @JavaTime.Relative(startTime.plus(Assessment.window))
                    <span class="text-muted">Europe/London</span>
                  </dd>
                }
              </dl>
              @a.assessment.platform match {
                case Platform.OnlineExams => {
                  <a href="/service/stub" class="btn btn-primary">
                    Start
                  </a>
                  <span class="text-danger">
                    <i class="fad fa-fw fa-hourglass"></i>30 minutes left to start
                  </span>
                }
                case Platform.Moodle => {
                  <a href="/service/stub" target="_blank">
                    Exam on Moodle<i class="fa fa-fw fa-external-link"></i>
                  </a>
                }
                case Platform.QuestionmarkPerception => {
                  <a href="/service/stub" target="_blank">
                    Exam on Questionmark Perception<i class="fa fa-fw fa-external-link"></i>
                  </a>
                }
              }
            </div>
          </div>
        </div>
      }
    </div>
  }
}
