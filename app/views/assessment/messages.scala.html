@import tags._
@import domain.Assessment
@import controllers.MessageController.MessageData
@import domain.AnnouncementOrQuery
@import warwick.sso.UniversityID
@import warwick.sso.Usercode
@import warwick.sso.User
@import domain.tabula
@(
    assessment: Assessment,
    messages: Seq[AnnouncementOrQuery],
    student: Map[UniversityID, tabula.SitsProfile],
    form: Form[MessageData],
    invigilators: Map[Usercode, User] = Map.empty[Usercode, User]
)(implicit context: RequestContext, request: RequestHeader, messagesProvider: MessagesProvider)

@frontend(s"Messages for ${assessment.title}") {
    <div class="alert alert-info media">
        <div class="media-left">
            <i class="fas fa-info-circle" aria-hidden="true"></i>
        </div>
        <div class="media-body">
            If you have concerns with specific parts of the assessment, you can use this
            form to bring it to the attention of an invigilator. Invigilators cannot assist
            you with understanding the assessment, but can look into potential errors
            and alert the entire cohort if necessary.
        </div>
    </div>

    <div class="row">
        <div class="col-sm-6">
            <p>
                @b3.vertical.formCSRF(controllers.routes.MessageController.submitForm(assessment.id)) { implicit fc =>
                    @b3.textarea(form("messageText"),
                        Symbol("_label") -> "Enter your message for the invigilator")

                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i> Send
                    </button>
                }
            </p>
            <p>
                <button type="button" class="btn btn-default" id="close-messages">
                    <i class="fas fa-times"></i>
                    Close messages tab
                </button>
            </p>
        </div>
        <div class="col-sm-6">
            <h3>My queries</h3>
            @displayAnnouncementsAndQueries(messages, student, "query", invigilators)
        </div>
    </div>

}
